<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MC ржЗржВрж░рзЗржЬрж┐ ржЙржЪрзНржЪрж╛рж░ржг ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгржХрж╛рж░рзА</title>
    
    <!-- Plausible Analytics -->
    <script async defer data-domain="mc-english-pronunciation.vercel.app" src="https://plausible.io/js/plausible.js"></script>
    
    <style>
        body { font-family: Arial, sans-serif; background: #f5f6fa; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { width: 90%; max-width: 600px; background: #fff; border-radius: 16px; box-shadow: 0 6px 20px rgba(0,0,0,0.1); padding: 20px; text-align: center; transition: opacity 0.3s; }
        h1, h2 { color: #333; }
        p { color: #555; line-height: 1.5; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 10px; margin: 5px; font-size: 16px; cursor: pointer; width: 100%; max-width: 200px; transition: background 0.3s; }
        button:hover { background: #0056b3; }
        .hidden { display: none; }
        .sentence-container { display: flex; align-items: center; justify-content: center; margin: 10px 0; flex-wrap: wrap; }
        .sentence { font-size: 22px; font-weight: bold; margin-right: 10px; }
        .meaning { font-size: 18px; color: #555; margin-bottom: 10px; }
        .icons { margin: 10px 0; display: flex; justify-content: center; align-items: center; }
        .icons span { font-size: 28px; cursor: pointer; margin: 0 20px; transition: transform 0.2s; }
        .icons span:hover { transform: scale(1.2); }
        .correct { color: green; }
        .wrong { color: red; text-decoration: underline wavy; }
        .notification { position: fixed; top: 20px; right: 20px; background: #fff; padding: 10px; border-radius: 5px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 1000; display: none; animation: fadeInOut 0.3s; }
        @keyframes fadeInOut { 0%, 100% { opacity: 0; } 50% { opacity: 1; } }
        .history { text-align: left; background: #f0f0f0; padding: 10px; margin-top: 10px; border-radius: 8px; max-height: 200px; overflow-y: auto; position: relative; }
        .history-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .clear-history { cursor: pointer; color: red; font-size: 18px; padding: 5px; }
        .progress { margin: 10px 0; font-weight: bold; }
        .glow { animation: glow 1s infinite alternate; }
        .recording { animation: recordingGlow 1s infinite alternate; }
        .userSpoken { margin-top: 10px; font-style: italic; color: #444; }
        .quick-guide { background: #e7f3ff; padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #007bff; }
        .step { display: flex; align-items: center; margin: 10px 0; text-align: left; }
        .step-number { background: #007bff; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-weight: bold; }
        @keyframes glow { 0% { text-shadow: 0 0 5px #007bff; } 100% { text-shadow: 0 0 20px #007bff; } }
        @keyframes recordingGlow { 0% { text-shadow: 0 0 5px #ff0000; } 100% { text-shadow: 0 0 20px #ff0000; } }
        @media (max-width: 480px) { .container { padding: 15px; } button { font-size: 14px; padding: 8px 16px; margin: 5px 0; width: 90%; } .icons span { font-size: 24px; margin: 0 10px; } .sentence { font-size: 18px; } .meaning { font-size: 16px; } .notification { right: 10px; left: 10px; top: 10px; } .history { max-height: 150px; font-size: 14px; } }
    </style>
</head>
<body>

<!-- Quick Guide Page -->
<div class="container" id="guidePage">
    <h1>ЁЯЪА рж╢рзБрж░рзБ ржХрж░рж╛рж░ ржЧрж╛ржЗржб</h1>
    
    <div class="quick-guide">
        <h3>ЁЯУЭ ржжрзНрж░рзБржд рж╢рзБрж░рзБ ржХрж░рзБржи (рзйржЯрж┐ рж╕рж╣ржЬ ржзрж╛ржк)</h3>
        
        <div class="step">
            <div class="step-number">1</div>
            <div>
                <strong>ржЗржВрж░рзЗржЬрж┐ ржмрж╛ржХрзНржп рж╢рзБржирзБржи</strong><br>
                <span style="color: #666;">ЁЯФК ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ рж╕ржарж┐ржХ ржЙржЪрзНржЪрж╛рж░ржг рж╢рзБржирзБржи</span>
            </div>
        </div>
        
        <div class="step">
            <div class="step-number">2</div>
            <div>
                <strong>ржЖржкржирж╛рж░ ржЙржЪрзНржЪрж╛рж░ржг рж░рзЗржХрж░рзНржб ржХрж░рзБржи</strong><br>
                <span style="color: #666;">ЁЯОд ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЗржВрж░рзЗржЬрж┐ ржмрж╛ржХрзНржп ржмрж▓рзБржи</span>
            </div>
        </div>
        
        <div class="step">
            <div class="step-number">3</div>
            <div>
                <strong>ржлрж┐ржбржмрзНржпрж╛ржХ ржкрж╛ржи ржУ рж╢рж┐ржЦрзБржи</strong><br>
                <span style="color: #666;">тЬЕ рж╕ржарж┐ржХ рж╢ржмрзНржж рж╕ржмрзБржЬ, тЭМ ржнрзБрж▓ рж╢ржмрзНржж рж▓рж╛рж▓ ржжрзЗржЦрж╛ржмрзЗ</span>
            </div>
        </div>
    </div>

    <div style="text-align: left; background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #ffc107;">
        <h4>ЁЯТб ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЯрж┐ржкрж╕:</h4>
        <ul style="text-align: left; color: #666;">
            <li><strong>Chrome ржмрзНрж░рж╛ржЙржЬрж╛рж░</strong> ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи (рж╕ржмржЪрзЗржпрж╝рзЗ ржнрж╛рж▓рзЛ ржХрж╛ржЬ ржХрж░рзЗ)</li>
            <li><strong>ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржЕржи</strong> рж░рж╛ржЦрзБржи</li>
            <li><strong>рж╢рж╛ржирзНржд ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝</strong> ржкрзНрж░рзНржпрж╛ржХржЯрж┐рж╕ ржХрж░рзБржи</li>
            <li><strong>ржзрзАрж░рзЗ ржзрзАрж░рзЗ</strong> ржУ <strong>ржкрж░рж┐рж╖рзНржХрж╛рж░ржнрж╛ржмрзЗ</strong> ржмрж▓рзБржи</li>
        </ul>
    </div>

    <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
        <button id="startLearning" style="background: #28a745;">ЁЯУЪ ржПржЦржиржЗ рж╢рзЗржЦрж╛ рж╢рзБрж░рзБ ржХрж░рзБржи</button>
        <button id="seeDetails" style="background: #6c757d;">тД╣я╕П ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЬрж╛ржирзБржи</button>
    </div>
</div>

<!-- Intro Page -->
<div class="container hidden" id="introPage">
    <h1>MC ржЗржВрж░рзЗржЬрж┐ ржЙржЪрзНржЪрж╛рж░ржг ржкрзНрж░рж╢рж┐ржХрзНрж╖ржгржХрж╛рж░рзА</h1>
    <p>ЁЯОп <b>ржПржЗ ржУржпрж╝рзЗржм ржЕрзНржпрж╛ржкржЯрж┐ ржХрзЗржи рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ?</b><br>
    ржмрж╛ржВрж▓рж╛ржнрж╛рж╖рзА рж╢рж┐ржХрзНрж╖рж╛рж░рзНржерзАржжрзЗрж░ ржЬржирзНржп ржЗржВрж░рзЗржЬрж┐ ржЙржЪрзНржЪрж╛рж░ржг рж╕рж╣ржЬржнрж╛ржмрзЗ рж╢рзЗржЦрж╛рж░ ржЙржжрзНржжрзЗрж╢рзНржпрзЗ ржПржЗ ржЕрзНржпрж╛ржкржЯрж┐ рждрзИрж░рж┐ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржЕржирзЗржХрзЗржЗ ржЗржВрж░рзЗржЬрж┐ рж╢ржмрзНржж ржкржбрж╝рждрзЗ ржкрж╛рж░рзЗ ржХрж┐ржирзНрждрзБ рж╕ржарж┐ржХ ржЙржЪрзНржЪрж╛рж░ржг ржХрж░рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝ред ржПржЗ ржЕрзНржпрж╛ржкржЯрж┐ рждрзЛржорж╛ржХрзЗ рж╕рзЗржЗ рж╕ржорж╕рзНржпрж╛ ржжрзВрж░ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░ржмрзЗред</p>

    <p>ЁЯУЪ <b>ржХрзА рж╢рж┐ржЦрждрзЗ ржкрж╛рж░ржмрзЗ?</b><br>
    - рж╕рж╣ржЬ ржЧрзНрж░рж┐ржЯрж┐ржВрж╕ ржерзЗржХрзЗ рж╢рзБрж░рзБ ржХрж░рзЗ ржЬржЯрж┐рж▓ ржЗржВрж░рзЗржЬрж┐ ржкрзНрж░ржмрж╛ржж<br>
    - рж╕ржарж┐ржХ ржЙржЪрзНржЪрж╛рж░ржгрзЗрж░ ржЯрзЗржХржирж┐ржХ<br>
    - ржЖрждрзНржоржмрж┐рж╢рзНржмрж╛рж╕рзЗрж░ рж╕рж╛ржерзЗ ржЗржВрж░рзЗржЬрж┐ ржмрж▓рж╛рж░ ржХрзНрж╖ржорждрж╛<br>
    - ржжрзИржиржирзНржжрж┐ржи ржЬрзАржмржирзЗ ржмрзНржпржмрж╣рзГржд ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржмрж╛ржХрзНржп</p>

    <p>ЁЯМЯ <b>ржмрж┐рж╢рзЗрж╖ рж╕рзБржмрж┐ржзрж╛:</b><br>
    - ржЧрзЗржорзЗрж░ ржорждрзЛ ржЖржирж▓ржХ рж╕рж┐рж╕рзНржЯрзЗржо<br>
    - ржЗржирж╕рзНржЯрзНржпрж╛ржирзНржЯ ржлрж┐ржбржмрзНржпрж╛ржХ<br>
    - ржмрж╛ржВрж▓рж╛ ржЕрж░рзНржерж╕рж╣ ржЗржВрж░рзЗржЬрж┐ ржмрж╛ржХрзНржп<br>
    - ржЕржЯрзЛ ржкрзНрж░рзЛржЧрзНрж░рзЗрж╕ рж╕рзЗржн</p>

    <button id="next1">ржмрзНржпржмрж╣рж╛рж░ ржмрж┐ржзрж┐ ржЬрж╛ржирзБржи тЮЬ</button>
</div>

<!-- HowTo Page -->
<div class="container hidden" id="howToPage">
    <h2>ржмрзНржпржмрж╣рж╛рж░ ржмрж┐ржзрж┐</h2>
    <p>1я╕ПтГг ржкрзНрж░ржержорзЗ 'ЁЯОд' ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржмрж╛ржХрзНржпржЯрж┐ ржЙржЪрзНржЪрж╛рж░ржг ржХрж░рзЛред<br>
       2я╕ПтГг рж╕ржарж┐ржХ рж╢ржмрзНржж рж╕ржмрзБржЬрзЗ ржжрзЗржЦрж╛ржмрзЗ, ржнрзБрж▓ рж▓рж╛рж▓ ржЖржирзНржбрж╛рж░рж▓рж╛ржЗржирзЗред<br>
       3я╕ПтГг рзй ржмрж╛рж░ рж╕ржарж┐ржХ ржЙржЪрзНржЪрж╛рж░ржг ржХрж░рж▓рзЗ ржкрж░ржмрж░рзНрждрзА рж╕рж┐ржЬржи ржЖржирж▓ржХ рж╣ржмрзЗред<br>
       4я╕ПтГг ржЗрждрж┐рж╣рж╛рж╕ ржмржХрзНрж╕рзЗ рждрзЛржорж╛рж░ рж╕рж╛ржорзНржкрзНрж░рждрж┐ржХ ржнрзБрж▓ ржжрзЗржЦрж╛ржмрзЗред<br>
       5я╕ПтГг рж░рж┐рж╕рзНржЯрж╛рж░рзНржЯ ржмрж╛ржЯржи ржжрж┐ржпрж╝рзЗ ржкрзБрж░рзЛ рж╕рж┐ржЬржи ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред</p>
    <button id="next2">рж╢рзБрж░рзБ ржХрж░рзЛ тЮЬ</button>
</div>

<!-- Main Page -->
<div class="container hidden" id="mainPage">
    <h2 id="engText">Sentence Here</h2>
    <p class="meaning" id="bnText">ржмрж╛ржВрж▓рж╛ ржЕрж░рзНрже ржПржЦрж╛ржирзЗ</p>

    <div class="icons">
        <span id="listenBtn" title="рж╢рзБржирзБржи ЁЯФК">ЁЯФК</span>
        <span id="speakBtn" title="ржЙржЪрзНржЪрж╛рж░ржг ржмрж▓рзБржи ЁЯОд">ЁЯОд</span>
        <span id="tryBtn" title="ржлрзЗрж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи ЁЯФБ">ЁЯФБ</span>
        <span id="nextBtn" title="ржкрж░ржмрж░рзНрждрзА ржмрж╛ржХрзНржп тЮбя╕П">тЮбя╕П</span>
        <span id="restartSeasonBtn" title="рж╕рж┐ржЬржи рж░рж┐рж╕рзНржЯрж╛рж░рзНржЯ ЁЯФД">ЁЯФД</span>
    </div>

    <div class="progress" id="progress">рж╕рж┐ржЬржи 1/21 - ржзрж╛ржк 1/5 | рж╕ржарж┐ржХ: 0/5</div>
    <div class="userSpoken" id="userSpokenText"></div>
    <div class="notification" id="note"></div>

    <!-- Quick Help Section -->
    <div style="background: #e7f3ff; padding: 10px; border-radius: 8px; margin: 10px 0; text-align: left;">
        <details>
            <summary><strong>тЭУ ржХрзАржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи?</strong></summary>
            <ol style="text-align: left; margin: 10px 0; padding-left: 20px;">
                <li><strong>ЁЯФК рж╢рзБржирзБржи</strong> - рж╕ржарж┐ржХ ржЙржЪрзНржЪрж╛рж░ржг рж╢рзБржирзБржи</li>
                <li><strong>ЁЯОд ржмрж▓рзБржи</strong> - ржорж╛ржЗржХрзНрж░рзЛржлрзЛржи ржЪрж╛рж▓рзБ ржХрж░рзЗ ржмрж▓рзБржи</li>
                <li><strong>тЬЕ ржлрж▓рж╛ржлрж▓ ржжрзЗржЦрзБржи</strong> - рж╕ржмрзБржЬ = рж╕ржарж┐ржХ, рж▓рж╛рж▓ = ржнрзБрж▓</li>
                <li><strong>тЮбя╕П ржкрж░ржмрж░рзНрждрзА</strong> - ржирждрзБржи ржмрж╛ржХрзНржпрзЗ ржпрж╛ржи</li>
            </ol>
        </details>
    </div>

    <div class="history" id="historyBox"></div>
</div><script>
    // 21 Seasons, 5 sentences each = 105 sentences
    const seasons = [
        [{en:"Hello",bn:"рж╣рзНржпрж╛рж▓рзЛ"},{en:"Good morning",bn:"рж╕рзБржкрзНрж░ржнрж╛ржд"},{en:"How are you?",bn:"ржЖржкржирж┐ ржХрзЗржоржи ржЖржЫрзЗржи?"},{en:"Thank you",bn:"ржзржирзНржпржмрж╛ржж"},{en:"Goodbye",bn:"ржмрж┐ржжрж╛ржпрж╝"}],
        [{en:"Good evening",bn:"рж╢рзБржн рж╕ржирзНржзрзНржпрж╛"},{en:"Nice to meet you",bn:"ржЖржкржирж╛рж░ рж╕рж╛ржерзЗ ржжрзЗржЦрж╛ рж╣ржпрж╝рзЗ ржнрж╛рж▓рзЛ рж▓рж╛ржЧрж▓рзЛ"},{en:"What is your name?",bn:"ржЖржкржирж╛рж░ ржирж╛ржо ржХрзА?"},{en:"Please",bn:"ржжржпрж╝рж╛ ржХрж░рзЗ"},{en:"Sorry",bn:"ржжрзБржГржЦрж┐ржд"}],
        [{en:"See you later",bn:"ржкрж░рзЗ ржжрзЗржЦрж╛ рж╣ржмрзЗ"},{en:"Have a good day",bn:"ржнрж╛рж▓рзЛ ржжрж┐ржи ржХрж╛ржЯрж╛ржи"},{en:"Welcome",bn:"рж╕рзНржмрж╛ржЧрждржо"},{en:"Excuse me",bn:"ржЕржЬрзБрж╣рж╛ржд ржжрж┐ржи"},{en:"Yes",bn:"рж╣рзНржпрж╛ржБ"}],
        [{en:"No",bn:"ржирж╛"},{en:"I am fine",bn:"ржЖржорж┐ ржнрж╛рж▓рзЛ ржЖржЫрж┐"},{en:"And you?",bn:"ржЖрж░ ржЖржкржирж┐?"},{en:"Good night",bn:"рж╢рзБржн рж░рж╛рждрзНрж░рж┐"},{en:"Take care",bn:"ржпрждрзНржи ржирж┐ржи"}],
        [{en:"How old are you?",bn:"ржЖржкржирж╛рж░ ржмржпрж╝рж╕ ржХржд?"},{en:"Where are you from?",bn:"ржЖржкржирж┐ ржХрзЛржерж╛ ржерзЗржХрзЗ?"},{en:"I love you",bn:"ржЖржорж┐ ржЖржкржирж╛ржХрзЗ ржнрж╛рж▓рзЛржмрж╛рж╕рж┐"},{en:"Happy birthday",bn:"ржЬржирзНржоржжрж┐ржи ржоржЩрзНржЧрж▓ржоржпрж╝ рж╣рзЛржХ"},{en:"Congratulations",bn:"ржЕржнрж┐ржиржирзНржжржи"}],
        [{en:"Sit down",bn:"ржмрж╕рзБржи"},{en:"Stand up",bn:"ржЙржарзБржи"},{en:"Open the door",bn:"ржжрж░ржЬрж╛ ржЦрзБрж▓рзБржи"},{en:"Close the window",bn:"ржЬрж╛ржирж╛рж▓рж╛ ржмржирзНржз ржХрж░рзБржи"},{en:"Eat your food",bn:"ржЖржкржирж╛рж░ ржЦрж╛ржмрж╛рж░ ржЦрж╛ржи"}],
        [{en:"Drink water",bn:"ржкрж╛ржирж┐ ржкрж╛ржи ржХрж░рзБржи"},{en:"Read the book",bn:"ржмржЗржЯрж┐ ржкржбрж╝рзБржи"},{en:"Write a letter",bn:"ржПржХржЯрж╛ ржЪрж┐ржарж┐ рж▓рж┐ржЦрзБржи"},{en:"Run fast",bn:"ржжрзНрж░рзБржд ржжрзМржбрж╝рж╛ржи"},{en:"Walk slowly",bn:"ржзрзАрж░рзЗ ржЪрж▓рзБржи"}],
        [{en:"Turn left",bn:"ржмрж╛ржорзЗ ржШрзБрж░рзБржи"},{en:"Go straight",bn:"рж╕рзЛржЬрж╛ ржпрж╛ржи"},{en:"Stop here",bn:"ржПржЦрж╛ржирзЗ ржерж╛ржорзБржи"},{en:"Help me",bn:"ржЖржорж╛ржХрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзБржи"},{en:"Call now",bn:"ржПржЦржи ржХрж▓ ржХрж░рзБржи"}],
        [{en:"Wash your hands",bn:"рж╣рж╛ржд ржзрзБржпрж╝рзЗ ржирж┐ржи"},{en:"Brush your teeth",bn:"ржжрж╛ржБржд ржмрзНрж░рж╛рж╢ ржХрж░рзБржи"},{en:"Sleep early",bn:"ржЖржЧрзЗ ржШрзБржорж╛ржи"},{en:"Wake up",bn:"ржЬрж╛ржЧрзБржи"},{en:"Study hard",bn:"ржХржарзЛрж░ ржкржбрж╝рж╛рж╢рзЛржирж╛ ржХрж░рзБржи"}],
        [{en:"Play outside",bn:"ржмрж╛ржЗрж░рзЗ ржЦрзЗрж▓рзБржи"},{en:"Share with friends",bn:"ржмржирзНржзрзБржжрзЗрж░ рж╕рж╛ржерзЗ рж╢рзЗржпрж╝рж╛рж░ ржХрж░рзБржи"},{en:"Be quiet",bn:"рж╢рж╛ржирзНржд ржерж╛ржХрзБржи"},{en:"Laugh loudly",bn:"ржЬрзЛрж░рзЗ рж╣рж╛рж╕рзБржи"},{en:"Sing a song",bn:"ржПржХржЯрж╛ ржЧрж╛ржи ржЧрж╛ржи ржХрж░рзБржи"}],
        [{en:"I am hungry",bn:"ржЖржорж╛рж░ ржХрзНрж╖рзБржзрж╛ ржкрзЗржпрж╝рзЗржЫрзЗ"},{en:"This is good",bn:"ржПржЯрж╛ ржнрж╛рж▓рзЛ"},{en:"That is bad",bn:"ржУржЯрж╛ ржЦрж╛рж░рж╛ржк"},{en:"I don't know",bn:"ржЖржорж┐ ржЬрж╛ржирж┐ ржирж╛"},{en:"I understand",bn:"ржЖржорж┐ ржмрзБржЭрзЗржЫрж┐"}],
        [{en:"I don't understand",bn:"ржЖржорж┐ ржмрзБржЭрждрзЗ ржкрж╛рж░ржЫрж┐ ржирж╛"},{en:"Can you help me?",bn:"ржЖржкржирж┐ ржХрж┐ ржЖржорж╛ржХрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи?"},{en:"Where is the toilet?",bn:"ржЯржпрж╝рж▓рзЗржЯржЯрж┐ ржХрзЛржерж╛ржпрж╝?"},{en:"How much is this?",bn:"ржПржЯрж╛рж░ ржжрж╛ржо ржХржд?"},{en:"I want this",bn:"ржЖржорж┐ ржПржЯрж╛ ржЪрж╛ржЗ"}],
        [{en:"I like it",bn:"ржЖржорж┐ ржПржЯрж╛ ржкржЫржирзНржж ржХрж░рж┐"},{en:"I don't like it",bn:"ржЖржорж┐ ржПржЯрж╛ ржкржЫржирзНржж ржХрж░рж┐ ржирж╛"},{en:"It's okay",bn:"ржарж┐ржХ ржЖржЫрзЗ"},{en:"No problem",bn:"ржХрзЛржи рж╕ржорж╕рзНржпрж╛ ржирзЗржЗ"},{en:"Of course",bn:"ржЕржмрж╢рзНржпржЗ"}],
        [{en:"Maybe",bn:"рж╣рждрзЗ ржкрж╛рж░рзЗ"},{en:"Never mind",bn:"ржХрж┐ржЫрзБ ржоржирзЗ ржХрж░рзЛ ржирж╛"},{en:"Hurry up",bn:"рждрж╛рж░рж╛рждрж╛рж░рж┐ ржХрж░рзЛ"},{en:"Wait a minute",bn:"ржПржХ ржорж┐ржирж┐ржЯ ржЕржкрзЗржХрзНрж╖рж╛ ржХрж░рзЛ"},{en:"Let's go",bn:"ржЪрж▓рзЛ ржпрж╛ржЗ"}],
        [{en:"Come here",bn:"ржПржЦрж╛ржирзЗ ржЖрж╕рзЛ"},{en:"Go there",bn:"рж╕рзЗржЦрж╛ржирзЗ ржпрж╛ржУ"},{en:"Look at this",bn:"ржПржЯрж╛ ржжрзЗржЦрзЛ"},{en:"Listen to me",bn:"ржЖржорж╛рж░ ржХржерж╛ рж╢рзБржирзЛ"},{en:"Be careful",bn:"рж╕рждрж░рзНржХ ржерж╛ржХрзЛ"}],
        [{en:"Good job",bn:"ржнрж╛рж▓рзЛ ржХрж╛ржЬ"},{en:"Well done",bn:"ржЕржнрж┐ржиржирзНржжржи"},{en:"You can do it",bn:"рждрзБржорж┐ ржкрж╛рж░ржмрзЗ"},{en:"Don't worry",bn:"ржЪрж┐ржирзНрждрж╛ ржХрж░рзЛ ржирж╛"},{en:"Believe in yourself",bn:"ржирж┐ржЬрзЗрж░ ржЙржкрж░ ржмрж┐рж╢рзНржмрж╛рж╕ рж░рж╛ржЦрзЛ"}],
        [{en:"Practice makes perfect",bn:"ржЕржирзБрж╢рзАрж▓ржиржЗ рж╕рж╛ржлрж▓рзНржпрзЗрж░ ржЪрж╛ржмрж┐ржХрж╛ржарж┐"},{en:"Never give up",bn:"ржХржЦржирзЛ рж╣рж╛рж▓ ржЫрзЗржбрж╝рзЛ ржирж╛"},{en:"Keep trying",bn:"ржЪрзЗрж╖рзНржЯрж╛ ржЪрж╛рж▓рж┐ржпрж╝рзЗ ржпрж╛ржУ"},{en:"You are learning",bn:"рждрзБржорж┐ рж╢рж┐ржЦржЫрзЛ"},{en:"Mistakes are okay",bn:"ржнрзБрж▓ ржХрж░рж╛ рж╕рзНржмрж╛ржнрж╛ржмрж┐ржХ"}],
        [{en:"The sky is blue",bn:"ржЖржХрж╛рж╢ ржирзАрж▓"},{en:"The sun is bright",bn:"рж╕рзВрж░рзНржп ржЙржЬрзНржЬрзНржмрж▓"},{en:"It is raining",bn:"ржмрзГрж╖рзНржЯрж┐ fallingржЫрзЗ"},{en:"I feel happy",bn:"ржЖржорж┐ ржЦрзБрж╢рж┐ ржмрзЛржз ржХрж░ржЫрж┐"},{en:"Today is beautiful",bn:"ржЖржЬржХрзЗрж░ ржжрж┐ржиржЯрж┐ рж╕рзБржирзНржжрж░"}],
        [{en:"Time is valuable",bn:"рж╕ржоржпрж╝ ржорзВрж▓рзНржпржмрж╛ржи"},{en:"Health is wealth",bn:"рж╕рзНржмрж╛рж╕рзНржерзНржпржЗ рж╕ржорзНржкржж"},{en:"Knowledge is power",bn:"ржЬрзНржЮрж╛ржиржЗ рж╢ржХрзНрждрж┐"},{en:"Love is eternal",bn:"ржнрж╛рж▓рзЛржмрж╛рж╕рж╛ ржЪрж┐рж░ржирзНрждржи"},{en:"Life is beautiful",bn:"ржЬрзАржмржи рж╕рзБржирзНржжрж░"}],
        [{en:"Actions speak louder than words",bn:"ржХржерж╛рж░ ржЪрзЗржпрж╝рзЗ ржХрж╛ржЬ ржмрзЗрж╢рж┐ ржЬрзЛрж░рж╛рж▓рзЛ"},{en:"Where there is a will there is a way",bn:"ржЗржЪрзНржЫрж╛ ржерж╛ржХрж▓рзЗ ржЙржкрж╛ржпрж╝ рж╣ржпрж╝"},{en:"Better late than never",bn:"ржХржЦржирзЛ ржирж╛ ржХрж░рж╛рж░ ржЪрзЗржпрж╝рзЗ ржжрзЗрж░рж┐рждрзЗ ржХрж░рж╛ ржнрж╛рж▓рзЛ"},{en:"Honesty is the best policy",bn:"рж╕рждрждрж╛ржЗ рж╕рж░рзНржмрзЛрждрзНрждржо ржкржирзНржерж╛"},{en:"Practice what you preach",bn:"ржпрж╛ ржкрзНрж░ржЪрж╛рж░ ржХрж░рзЛ рждрж╛ ржирж┐ржЬрзЗ ржЕржирзБрж╢рзАрж▓ржи ржХрж░рзЛ"}]
    ];

    // State
    let currentSeason = 0;
    let currentStep = 0;
    let correctInSeries = 0;
    let sentenceCorrectStatus = [false, false, false, false, false];
    let history = [];
    const totalSeasons = seasons.length;
    let recognizing = false;

    // DOM
    const guidePage = document.getElementById("guidePage");
    const introPage = document.getElementById("introPage");
    const howToPage = document.getElementById("howToPage");
    const mainPage = document.getElementById("mainPage");
    const engText = document.getElementById("engText");
    const bnText = document.getElementById("bnText");
    const listenBtn = document.getElementById("listenBtn");
    const speakBtn = document.getElementById("speakBtn");
    const nextBtn = document.getElementById("nextBtn");
    const tryBtn = document.getElementById("tryBtn");
    const restartBtn = document.getElementById("restartSeasonBtn");
    const note = document.getElementById("note");
    const historyBox = document.getElementById("historyBox");
    const progressBox = document.getElementById("progress");
    const userSpokenText = document.getElementById("userSpokenText");

    // New Navigation for Guide
    document.getElementById("startLearning").addEventListener("click", () => {
        guidePage.classList.add("hidden");
        mainPage.classList.remove("hidden");
        loadState();
        loadSentence();
    });

    document.getElementById("seeDetails").addEventListener("click", () => {
        guidePage.classList.add("hidden");
        introPage.classList.remove("hidden");
    });

    // Rest of the navigation
    document.getElementById("next1").addEventListener("click", () => {
        introPage.classList.add("hidden");
        howToPage.classList.remove("hidden");
    });

    document.getElementById("next2").addEventListener("click", () => {
        howToPage.classList.add("hidden");
        mainPage.classList.remove("hidden");
        loadState();
        loadSentence();
    });

    // Load saved state
    function loadState() {
        currentSeason = parseInt(localStorage.getItem('currentSeason')) || 0;
        correctInSeries = parseInt(localStorage.getItem(`correctInSeason${currentSeason}`)) || 0;
        const savedStatus = localStorage.getItem(`statusSeason${currentSeason}`);
        sentenceCorrectStatus = savedStatus ? JSON.parse(savedStatus) : [false, false, false, false, false];
        
        const savedHistory = localStorage.getItem("history");
        history = savedHistory ? JSON.parse(savedHistory) : [];
    }

    // Levenshtein Distance
    function levenshteinDistance(a, b) {
        const matrix = [];
        for (let i = 0; i <= b.length; i++) matrix[i] = [i];
        for (let j = 0; j <= a.length; j++) matrix[0][j] = j;
        for (let i = 1; i <= b.length; i++) {
            for (let j = 1; j <= a.length; j++) {
                if (b[i - 1] === a[j - 1]) matrix[i][j] = matrix[i - 1][j - 1];
                else matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j] + 1);
            }
        }
        return matrix[b.length][a.length];
    }

    // Load Sentence
    function loadSentence() {
        let used = JSON.parse(localStorage.getItem(`usedSeason${currentSeason}`)) || [];
        let randIndex = Math.floor(Math.random() * 5);
        while (used.includes(randIndex) && used.length < 5) randIndex = Math.floor(Math.random() * 5);
        if (!used.includes(randIndex)) {
            used.push(randIndex);
            localStorage.setItem(`usedSeason${currentSeason}`, JSON.stringify(used));
        }
        currentStep = randIndex;
        const s = seasons[currentSeason][currentStep];
        engText.innerHTML = s.en;
        bnText.innerText = s.bn;
        userSpokenText.innerText = "";
        note.style.display = "none";
        displayProgress();
        displayHistory();
        localStorage.setItem('currentStep', currentStep);
    }

    // Display Progress
    function displayProgress() {
        progressBox.innerText = `рж╕рж┐ржЬржи ${currentSeason + 1}/${totalSeasons} - ржзрж╛ржк ${currentStep + 1}/5 | рж╕ржарж┐ржХ: ${correctInSeries}/5`;
    }

    // Show notification
    function showNote(message, duration, color) {
        note.innerText = message;
        note.style.color = color || "black";
        note.style.display = "block";
        setTimeout(() => {
            note.style.display = "none";
        }, duration);
    }    // TTS
    listenBtn.addEventListener("click", () => {
        if (!('speechSynthesis' in window)) {
            showNote("TTS рж╕рж╛ржкрзЛрж░рзНржЯ ржХрж░рж╛ рж╣ржпрж╝ржирж┐! Chrome ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред", 2000, "red");
            return;
        }
        const utter = new SpeechSynthesisUtterance(seasons[currentSeason][currentStep].en);
        utter.lang = 'en-US';
        speechSynthesis.speak(utter);
    });

    // STT
    speakBtn.addEventListener("click", () => {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
            showNote("Speech recognition рж╕рж╛ржкрзЛрж░рзНржЯ ржХрж░рж╛ рж╣ржпрж╝ржирж┐! Chrome ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛред", 3000, "red");
            return;
        }
        if (recognizing) return;
        
        const recognition = new SpeechRecognition();
        recognition.lang = 'en-US';
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;
        
        recognizing = true;
        speakBtn.classList.add("recording");
        speakBtn.innerHTML = "ЁЯОдЁЯФ┤";
        showNote("ржЙржЪрзНржЪрж╛рж░ржг ржмрж▓рзЛ... (рж╢рж╛ржирзНржд ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ ржмрж▓рзЛ)", 3000, "blue");
        
        recognition.start();
        
        recognition.onresult = (event) => {
            recognizing = false;
            speakBtn.classList.remove("recording");
            speakBtn.innerHTML = "ЁЯОд";
            const transcript = event.results[0][0].transcript.trim();
            userSpokenText.innerText = `рждрзБржорж┐ ржмрж▓рзЗржЫрзЛ: ${transcript}`;
            checkPronunciation(transcript);
        };
        
        recognition.onerror = () => {
            recognizing = false;
            speakBtn.classList.remove("recording");
            speakBtn.innerHTML = "ЁЯОд";
            showNote("STT рждрзНрж░рзБржЯрж┐: ржорж╛ржЗржХ ржЪрзЗржХ ржХрж░рзЛ ржмрж╛ рж╢рж╛ржирзНржд ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЛ!", 3000, "red");
        };
        
        recognition.onend = () => {
            recognizing = false;
            speakBtn.classList.remove("recording");
            speakBtn.innerHTML = "ЁЯОд";
        };
    });

    // Check Pronunciation
    function checkPronunciation(transcript) {
        const original = seasons[currentSeason][currentStep].en.toLowerCase().replace(/[^\w\s]/g, "");
        const spokenWords = transcript.toLowerCase().replace(/[^\w\s]/g, "").split(" ");
        const origWords = original.split(" ");
        let feedback = [];
        let correctCount = 0;
        let historyAdds = [];
        
        origWords.forEach((w, i) => {
            const userWord = spokenWords[i] || "";
            const distance = levenshteinDistance(userWord, w);
            const similarity = 1 - (distance / Math.max(userWord.length, w.length || 1));
            
            if (similarity >= 0.8) {
                feedback.push(`<span class="correct">${origWords[i]}</span>`);
                correctCount++;
            } else {
                feedback.push(`<span class="wrong">${origWords[i]}</span>`);
                historyAdds.push({ wrong: userWord || "(ржирзЗржЗ)", right: origWords[i] });
            }
        });
        
        engText.innerHTML = feedback.join(" ");
        historyAdds.forEach(h => history.push(h));
        if (history.length > 5) history = history.slice(-5);
        localStorage.setItem("history", JSON.stringify(history));
        displayHistory();
        
        if (correctCount === origWords.length) {
            if (!sentenceCorrectStatus[currentStep]) {
                sentenceCorrectStatus[currentStep] = true;
                correctInSeries++;
                localStorage.setItem(`correctInSeason${currentSeason}`, correctInSeries);
                localStorage.setItem(`statusSeason${currentSeason}`, JSON.stringify(sentenceCorrectStatus));
                showNote("ЁЯОЙ рж╕ржарж┐ржХ ржЙржЪрзНржЪрж╛рж░ржг! +1 ржкржпрж╝рзЗржирзНржЯ", 2000, "green");
                
                if (correctInSeries >= 3) {
                    if (currentSeason < totalSeasons - 1) {
                        currentSeason++;
                        localStorage.setItem('currentSeason', currentSeason);
                        correctInSeries = 0;
                        sentenceCorrectStatus = [false, false, false, false, false];
                        localStorage.setItem(`correctInSeason${currentSeason}`, 0);
                        localStorage.setItem(`statusSeason${currentSeason}`, JSON.stringify(sentenceCorrectStatus));
                        localStorage.removeItem(`usedSeason${currentSeason - 1}`);
                        showNote(`ЁЯОК рж╕рж┐ржЬржи ${currentSeason} ржЖржирж▓ржХ рж╣ржпрж╝рзЗржЫрзЗ!`, 3000, "blue");
                    } else {
                        showNote("ЁЯОК рж╕ржм рж╕рж┐ржЬржи рж╕ржорзНржкржирзНржи! ржЕржнрж┐ржиржирзНржжржи!", 3000, "green");
                    }
                }
            }
        } else {
            showNote("ржЙржЪрзНржЪрж╛рж░ржг ржЖржмрж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЛ", 2000, "red");
        }
        
        displayProgress();
    }

    // Display History
    function displayHistory() {
        if (history.length === 0) {
            historyBox.innerHTML = "<div class='history-header'><span>ржЗрждрж┐рж╣рж╛рж╕:</span><span class='clear-history' onclick='clearHistory()'>тЭМ</span></div><p>ржХрзЛржи ржнрзБрж▓ ржирзЗржЗ</p>";
            return;
        }
        
        let historyHTML = "<div class='history-header'><span>ржЗрждрж┐рж╣рж╛рж╕:</span><span class='clear-history' onclick='clearHistory()'>тЭМ</span></div>";
        history.forEach(item => {
            historyHTML += `<p><span class='wrong'>${item.wrong}</span> тЖТ <span class='correct'>${item.right}</span></p>`;
        });
        historyBox.innerHTML = historyHTML;
    }

    // Clear History
    function clearHistory() {
        history = [];
        localStorage.setItem("history", JSON.stringify(history));
        displayHistory();
    }

    // Next button
    nextBtn.addEventListener("click", () => {
        loadSentence();
    });

    // Try again button
    tryBtn.addEventListener("click", () => {
        const s = seasons[currentSeason][currentStep];
        engText.innerHTML = s.en;
        bnText.innerText = s.bn;
        userSpokenText.innerText = "";
        note.style.display = "none";
    });

    // Restart season button
    restartBtn.addEventListener("click", () => {
        if (confirm("ржкрзБрж░рзЛ рж╕рж┐ржЬржи ржЖржмрж╛рж░ рж╢рзБрж░рзБ ржХрж░рждрзЗ ржЪрж╛ржУ?")) {
            sentenceCorrectStatus = [false, false, false, false, false];
            correctInSeries = 0;
            localStorage.setItem(`correctInSeason${currentSeason}`, 0);
            localStorage.setItem(`statusSeason${currentSeason}`, JSON.stringify(sentenceCorrectStatus));
            localStorage.removeItem(`usedSeason${currentSeason}`);
            loadSentence();
            showNote("рж╕рж┐ржЬржи рж░рж┐рж╕рзНржЯрж╛рж░рзНржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ", 2000, "blue");
        }
    });

    // Initialize
    displayHistory();
</script>
</body>
</html>